<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ page import="java.io.PrintWriter" %>
<%@ page import="board.Board" %>
<%@ page import="board.BoardDAO" %>
<%@include file = "/assets/header.jsp"%>
<%
		
		if(userID == null) {
			PrintWriter script = response.getWriter();
			script.println("<script>");
			script.println("alert('로그인을 하세요.')");
			script.println("location.href = '/bank/login_view.jsp'");
			script.println("</script>");
		}
		int bbsID = 0;
		if (request.getParameter("bbsID") != null) {
			bbsID = Integer.parseInt(request.getParameter("bbsID"));
		}
		if(bbsID == 0) {
			PrintWriter script = response.getWriter();
			script.println("<script>");
			script.println("alert('유효하지 않은 글입니다.')");
			script.println("location.href = '/bank/fileupdown/board.jsp'");
			script.println("</script>");
		}
		Board board = new BoardDAO().getboard(bbsID);
		if(!userID.equals(board.getu_id())) {
			PrintWriter script = response.getWriter();
			script.println("<script>");
			script.println("alert('권한이 없습니다.')");
			script.println("location.href = '/bank/fileupdown/board.jsp'");
			script.println("</script>");
		}
	%>
<div class="bg-light">

  <div class="page-hero-section bg-image hero-mini" style="background-image: url(/bank/assets/img/hero_mini.svg);">
    <div class="hero-caption">
      <div class="container fg-white h-100">
        <div class="row justify-content-center align-items-center text-center h-100">
          <div class="col-lg-6">
            <h3 class="mb-4 fw-medium">File Up&Download Board</h3>
            <nav aria-label="breadcrumb">
              <ol class="breadcrumb breadcrumb-dark justify-content-center bg-transparent">
                <li class="breadcrumb-item"><a href="/bank/main.jsp">Home</a></li>
                <li class="breadcrumb-item active" aria-current="page">File Up&Download Board</li>
              </ol>
            </nav>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="page-section">
    <div class="container">
      <div class="row justify-content-center">
        <div class="col-md-10 col-lg-10 my-3 wow fadeInUp">
          <div class="card-page">
            <h3 class="fw-normal">Edit</h3>
            <form method="POST" class="mt-3" action="/bank/fileupdown/board_update_controller.jsp?bbsID=<%= bbsID%>" enctype="multipart/form-data">
              <div class="form-group">
                <label for="generic_title" class="fw-medium fg-grey">Title</label>
                <input type="text" class="form-control" placeholder="Title" name="generic_title" value="<%= board.gettitle()%>">
              </div>
     
			  <div class="form-group">
                <label for="generic_content" class="fw-medium fg-grey">Content</label>
                <textarea class="form-control" placeholder="Content" name="generic_content" maxlength="2048" style="height: 350px;"><%= board.getcontent()%></textarea>
              </div>
			  
              <% if(board.getfilepath() != null){
              String s = board.getfilepath();
              int startIndex = s.indexOf("uploadedFiles\\") + "uploadedFiles\\".length();
              String result = s.substring(startIndex);%>
        <div class="form-group">
          <p>현재 업로드된 파일: <%=result%></p>
        </div>
      <%}%>
			  <div class="form-group">
                <input type = "file" name = "generic_file"/>
              </div>
    
              <div class="form-group mt-4">
			  
			  <div class="col-sm">
              <button type="submit" class="btn btn-primary btn-block btn-sm">edit</button>
			  </div>
			  </form>
              
    
			
                
              </div>
			  
          </div>
        </div>
      </div>
    </div>
  </div>

</div> <!-- .bg-light -->

<%@include file = "/assets/footer.jsp"%>
</body>
</html>